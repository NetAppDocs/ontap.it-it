---
permalink: san-admin/enable-space-allocation-scsi-thin-provisioned-luns-task.html 
sidebar: sidebar 
keywords: enable, space, allocation, scsi, thinly, provisioned luns 
summary: 'Se si imposta l"opzione di allocazione dello spazio su abilitato, ONTAP notifica all"host quando il volume ha esaurito lo spazio e il LUN nel volume non può accettare le scritture. Questa opzione consente inoltre a ONTAP di recuperare automaticamente lo spazio quando l"host elimina i dati.' 
---
= Abilitare l'allocazione dello spazio per LUN con thin provisioning SCSI
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Se l'host supporta il thin provisioning SCSI, è possibile attivare l'allocazione dello spazio per i LUN SCSI con thin provisioning in ONTAP.  Quando l'allocazione dello spazio è attivata, ONTAP invia una notifica all'host quando lo spazio del volume è esaurito e il LUN del volume non può accettare scritture. ONTAP recupera automaticamente anche spazio quando l'host elimina i dati.

Negli host che non supportano il thin provisioning SCSI, quando il volume contenente il LUN esaurisce lo spazio e non può crescere automaticamente, ONTAP porta il LUN offline. Sugli host che supportano il thin provisioning SCSI, ONTAP non porta il LUN offline quando si esaurisce lo spazio. Il LUN rimane in linea in modalità di sola lettura e all'host viene notificato che il LUN non può più accettare le scritture.

Inoltre, quando i dati vengono eliminati su un host che supporta il thin provisioning SCSI, la gestione dello spazio sul lato host identifica i blocchi di dati eliminati sul file system host ed emette automaticamente uno o più `SCSI UNMAP` comandi per liberare i blocchi corrispondenti sul sistema storage.

.Prima di iniziare
Per attivare l'allocazione dello spazio, il thin provisioning SCSI deve essere supportato dall'host. Il thin provisioning SCSI utilizza il provisioning a blocchi logici come definito nello standard SCSI SBC-3. Solo gli host che supportano questo standard possono utilizzare il thin provisioning SCSI in ONTAP.

I seguenti host attualmente supportano il thin provisioning SCSI quando si attiva l'allocazione dello spazio:

* Citrix XenServer 6,5 e versioni successive
* ESXi 5,0 e versioni successive
* Kernel Oracle Linux 6,2 UEK o versione successiva
* RHEL 6,2 e versioni successive
* SLES11 e versioni successive
* Solaris 11,1 e versioni successive
* Windows


.A proposito di questa attività
Per impostazione predefinita, l'allocazione dello spazio è disattivata per tutti i LUN. Per attivare l'allocazione dello spazio, è necessario portare il LUN in modalità non in linea; quindi è necessario eseguire la ricerca sull'host prima che l'host riconosca che l'allocazione dello spazio è stata abilitata.

.Fasi
. Portare il LUN offline.
+
[source, cli]
----
lun modify -vserver vserver_name -volume volume_name -lun lun_name -state offline
----
. Attiva allocazione spazio:
+
[source, cli]
----
lun modify -vserver _vserver_name_ -volume _volume_name_ -lun _lun_name_ -space-allocation enabled
----
. Verificare che l'allocazione dello spazio sia attivata:
+
[source, cli]
----
lun show -vserver _vserver_name_ -volume _volume_name_ -lun _lun_name_ -fields space-allocation
----
. Portare il LUN online:
+
[source, cli]
----
lun modify -vserver _vserver_name_ -volume _volume_name_ -lun _lun_name_ -state online
----
. Sull'host, eseguire nuovamente la scansione di tutti i dischi per assicurarsi che la modifica apportata a `-space-allocation` l'opzione è stata rilevata correttamente.

