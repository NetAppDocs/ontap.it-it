---
permalink: mediator/verify-code-signature-task.html 
sidebar: sidebar 
keywords: mediator, new, release, update, install, verify, code, signature 
summary: Prima di installare il pacchetto di installazione di ONTAP, verificare la firma del codice del mediatore. 
---
= Verificare la firma del codice del mediatore ONTAP
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
NetApp consiglia di verificare la firma del codice ONTAP Mediator prima dell'installazione. Questo passaggio è facoltativo.

.Prima di iniziare
Prima di verificare la firma del codice ONTAP Mediator, accertarsi che il sistema soddisfi queste esigenze.

[NOTE]
====
* Dal 15 giugno 2025, non sarà più possibile installare o aggiornare ONTAP Mediator 1.9 e 1.8 perché i certificati di verifica della firma digitale sono scaduti. In alternativa, installare o aggiornare ONTAP Mediator alla versione 1.11 o 1.10.
* Se il sistema non soddisfa i requisiti indicati di seguito, il processo di verifica non è necessario e si può andare direttamente a link:install-mediator-pkg-task.html["Installare il pacchetto di installazione di ONTAP Mediator"].


====
* openssl versioni da 1.0.2 a 3.0 per la verifica di base
* openssl versione 1.1.0 o successiva per le operazioni TSA (Time Stamping Authority)
* Accesso a Internet pubblico per la verifica OCSP


Il pacchetto di download include i seguenti file:

[cols="50,50"]
|===


| File | Descrizione 


 a| 
`ONTAP-Mediator-production.pub`
 a| 
Chiave pubblica utilizzata per verificare la firma



 a| 
`csc-prod-chain-ONTAP-Mediator.pem`
 a| 
Catena di trust della CA per la certificazione pubblica



 a| 
`csc-prod-ONTAP-Mediator.pem`
 a| 
Il certificato utilizzato per generare la chiave



 a| 
`ontap-mediator-1.11.0`
 a| 
L'eseguibile di installazione del prodotto per la versione 1.11



 a| 
`ontap-mediator-1.11.0.sig`
 a| 
SHA-256 ha eseguito l'hashing, quindi ha firmato RSA utilizzando la chiave csc-PROD, firma per l'installatore



 a| 
`ontap-mediator-1.11.0.sig.tsr`
 a| 
La richiesta di revoca per l'utilizzo da parte di OCSCP per la firma dell'installatore



 a| 
`ontap-mediator-1.11.0.tsr`
 a| 
File di richiesta firma timestamp



 a| 
`tsa-prod-ONTAP-Mediator.pem`
 a| 
Il certificato pubblico per il TSR



 a| 
`tsa-prod-chain-ONTAP-Mediator.pem`
 a| 
La catena CA del certificato pubblico per il TSR

|===
.Fasi
. Eseguire il controllo della revoca su `csc-prod-ONTAP-Mediator.pem` Utilizzando il protocollo OCSP (Online Certificate Status Protocol).
+
.. Trova l'URL OCSP per il certificato.  I certificati degli sviluppatori potrebbero non fornire un URI:
+
[listing]
----
openssl x509 -noout -ocsp_uri -in csc-prod-chain-ONTAP-Mediator.pem
----
.. Generare una richiesta OCSP per il certificato.
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -reqout req.der
----
.. Connettersi a OCSP Manager per inviare la richiesta OCSP:
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -url ${ocsp_uri} -resp_text -respout resp.der -verify_other csc-prod-chain-ONTAP-Mediator.pem
----


. Verificare la catena di attendibilità del CSC e le date di scadenza rispetto all'host locale:
+
`openssl verify`

+

NOTE: Il `openssl` La versione dal PERCORSO deve avere un valido `cert.pem` (non autofirmato).

+
[listing]
----
openssl verify -untrusted csc-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} csc-prod-ONTAP-Mediator.pem  # Failure action: The Code-Signature-Check certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
openssl verify -untrusted tsa-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} tsa-prod-ONTAP-Mediator.pem  # Failure action: The Time-Stamp certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
----
. Verificare il `ontap-mediator-1.11.0.sig.tsr` E `ontap-mediator-1.11.0.tsr` file utilizzando i certificati associati:
+
[role="tabbed-block"]
====
.OpenSSL 3.x
--
`openssl ts -verify -data ontap-mediator-1.11.0.sig -in ontap-mediator-1.11.0.sig.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem`

--
.OpenSSL 1.x
--
`openssl ts -verify -data ontap-mediator-1.11.0 -in ontap-mediator-1.11.0.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -partial_chain`

--
====
+

NOTE: `.tsr`I file contengono la risposta con timestamp associata al programma di installazione e la firma del codice.  L'elaborazione conferma che il timestamp ha una firma valida da parte della TSA e che il file di input non è stato modificato.  La macchina esegue la verifica localmente.  Non è necessario accedere ai server TSA.

. Verificare le firme rispetto alla chiave:
+
`openssl -dgst -verify`

+
[listing]
----
openssl dgst -sha256 -verify ONTAP-Mediator-production.pub -signature ontap-mediator-1.11.0.sig ontap-mediator-1.11.0
----

