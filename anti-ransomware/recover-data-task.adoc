---
sidebar: sidebar 
permalink: anti-ransomware/recover-data-task.html 
keywords: Restore data after an attack, anti-ransomware backup, restore data from snapshots, potential ransomware attack, ransomware attack, recovery snapshots are deleted, recover deleted snapshots, autonomous, ransomware, protection, arp 
summary: Gli snapshot vengono creati quando ARP rileva un potenziale attacco. Puoi ripristinare i dati da queste copie anti-ransomware o da altri snapshot. 
---
= Ripristina i dati dagli snapshot ONTAP ARP dopo un attacco ransomware
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
La protezione autonoma dal ransomware (ARP) crea snapshot denominate `Anti_ransomware_backup` quando rileva una potenziale minaccia ransomware. È possibile utilizzare uno di questi snapshot ARP o un altro snapshot del volume per ripristinare i dati.

.A proposito di questa attività
Se il volume dispone di relazioni SnapMirror, replica manualmente tutte le copie mirror del volume subito dopo il ripristino da uno Snapshot. In caso contrario, le copie mirror non possono essere utilizzabili e devono essere eliminate e ricreate.

Per eseguire il ripristino da uno snapshot diverso dallo `Anti_ransomware_backup` snapshot dopo l'identificazione di un attacco di sistema, è necessario rilasciare lo snapshot ARP.

Se non è stato segnalato alcun attacco al sistema, devi prima eseguire il ripristino dallo `Anti_ransomware_backup` snapshot, quindi completare un successivo ripristino del volume dallo snapshot scelto.

.Fasi
Per ripristinare i dati, è possibile utilizzare Gestione di sistema o l'interfaccia utente di ONTAP.

[role="tabbed-block"]
====
.System Manager
--
.Ripristino dopo un attacco di sistema
. Per eseguire il ripristino dallo snapshot ARP, passare direttamente al punto 2. Per eseguire il ripristino da uno snapshot precedente, è necessario prima rilasciare il blocco sullo snapshot ARP.
+
.. Selezionare *Storage > Volumes* (Storage > volumi).
.. Selezionare *sicurezza*, quindi *Visualizza tipi di file sospetti*.
.. Contrassegna i file come "potenziale attacco ransomware".
.. Selezionare *Aggiorna* e *Cancella tipi di file sospetti*.


. Visualizzare le istantanee in volumi:
+
Selezionare *archiviazione > volumi*, quindi selezionare il volume e *Snapshot Copies*.

. Selezionare image:icon_kabob.gif["Icona delle opzioni di menu"] accanto allo snapshot che si desidera ripristinare, quindi *Restore*.


.Ripristinare se non è stato identificato un attacco di sistema
. Visualizzare le istantanee in volumi:
+
Selezionare *archiviazione > volumi*, quindi selezionare il volume e *Snapshot Copies*.

. Selezionarli e image:icon_kabob.gif["Icona delle opzioni di menu"] scegliere l' `Anti_ransomware_backup`istantanea.
. Selezionare *Restore* (Ripristina).
. Tornare al menu *Snapshot Copies*, quindi scegliere l'istantanea che si desidera utilizzare. Selezionare *Restore* (Ripristina).


--
.CLI
--
.Ripristino dopo un attacco di sistema
. Per eseguire il ripristino dallo snapshot ARP, passare direttamente al punto 2. Per ripristinare i dati dalle istantanee precedenti, è necessario rilasciare il blocco sullo snapshot ARP.
+

NOTE: È necessario rilasciare il SnapLock anti-ransomware prima del ripristino da snapshot precedenti, se si utilizza il `volume snapshot restore` comando come descritto di seguito. Se i dati vengono ripristinati utilizzando FlexClone, Ripristino snap file singolo o altri metodi, ciò non è necessario.

+
Contrassegnare l'attacco come potenziale attacco ransomware (`-false-positive false`) e cancellare i file sospetti (`clear-suspect`):
`anti-ransomware volume attack clear-suspect -vserver _svm_name_ -volume _vol_name_ [_extension identifiers_] -false-positive false` Utilizzare uno dei seguenti parametri per identificare le estensioni: Numero di sequenza del
`[-seq-no _integer_]` file nell'elenco sospetto.
`[-extension _text_, … ]` Orari di inizio e di fine delle estensioni
`[-start-time _date_time_ -end-time _date_time_]` dei file per l'intervallo di file da cancellare, nel formato "MM/GG/AAAA HH:MM:SS".

. Elencare gli snapshot in un volume:
+
[source, cli]
----
volume snapshot show -vserver <SVM> -volume <volume>
----
+
L'esempio seguente mostra l'istantanea in `vol1`:

+
[listing]
----

clus1::> volume snapshot show -vserver vs1 -volume vol1

Vserver Volume Snapshot                State    Size  Total% Used%
------- ------ ---------- ----------- ------   -----  ------ -----
vs1	    vol1   hourly.2013-01-25_0005  valid   224KB     0%    0%
               daily.2013-01-25_0010   valid   92KB      0%    0%
               hourly.2013-01-25_0105  valid   228KB     0%    0%
               hourly.2013-01-25_0205  valid   236KB     0%    0%
               hourly.2013-01-25_0305  valid   244KB     0%    0%
               hourly.2013-01-25_0405  valid   244KB     0%    0%
               hourly.2013-01-25_0505  valid   244KB     0%    0%

7 entries were displayed.
----
. Ripristinare il contenuto di un volume da uno snapshot:
+
[source, cli]
----
volume snapshot restore -vserver <SVM> -volume <volume> -snapshot <snapshot>
----
+
Nell'esempio riportato di seguito viene ripristinato il contenuto di `vol1`:

+
[listing]
----
cluster1::> volume snapshot restore -vserver vs0 -volume vol1 -snapshot daily.2013-01-25_0010
----


.Ripristinare se non è stato identificato un attacco di sistema
. Elencare gli snapshot in un volume:
+
[source, cli]
----
volume snapshot show -vserver <SVM> -volume <volume>
----
+
L'esempio seguente mostra l'istantanea in `vol1`:

+
[listing]
----

clus1::> volume snapshot show -vserver vs1 -volume vol1

Vserver Volume Snapshot                State    Size  Total% Used%
------- ------ ---------- ----------- ------   -----  ------ -----
vs1	    vol1   hourly.2013-01-25_0005  valid   224KB     0%    0%
               daily.2013-01-25_0010   valid   92KB      0%    0%
               hourly.2013-01-25_0105  valid   228KB     0%    0%
               hourly.2013-01-25_0205  valid   236KB     0%    0%
               hourly.2013-01-25_0305  valid   244KB     0%    0%
               hourly.2013-01-25_0405  valid   244KB     0%    0%
               hourly.2013-01-25_0505  valid   244KB     0%    0%

7 entries were displayed.
----
. Ripristinare il contenuto di un volume da uno snapshot:
+
[source, cli]
----
volume snapshot restore -vserver <SVM> -volume <volume> -snapshot <snapshot>
----
+
Nell'esempio riportato di seguito viene ripristinato il contenuto di `vol1`:

+
[listing]
----
cluster1::> volume snapshot restore -vserver vs0 -volume vol1 -snapshot daily.2013-01-25_0010
----
. Ripetere i passaggi 1 e 2 per ripristinare il volume utilizzando l'istantanea desiderata.


--
Ulteriori informazioni su `volume snapshot` nella link:https://docs.netapp.com/us-en/ontap-cli/search.html?q=volume+snapshot["Riferimento al comando ONTAP"^].

====
.Informazioni correlate
* link:https://kb.netapp.com/Advice_and_Troubleshooting/Data_Storage_Software/ONTAP_OS/Ransomware_prevention_and_recovery_in_ONTAP["KB: Prevenzione e recovery dal ransomware in ONTAP"^]
* link:https://docs.netapp.com/us-en/ontap-cli/["Riferimento al comando ONTAP"^]

